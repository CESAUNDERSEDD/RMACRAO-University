<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RMACRAO University</title>
    <style>
        /* Basic styling */
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; height: 100vh; overflow: hidden; }
        #welcomeMessage { font-size: 18px; font-weight: bold; margin: 10px; text-align: center; }
		#gameArea {
			display: none;
			width: 500px;
			height: 500px;
			position: relative;
			background-image: url('RMACRAOUniversity1.png');
			background-size: cover;
			background-position: center;
			border: 1px solid #ddd;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
		}

        /* Desk container styling */
        .desk-container { position: absolute; width: 80px; height: 70px; display: flex; flex-direction: column; align-items: center; }
        .desk { background-color: #f5f5dc; border: 2px solid #ddd; border-radius: 8px; width: 80px; height: 40px; display: flex; justify-content: center; align-items: center; box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2); text-align: center; font-size: 12px; font-weight: bold; color: #333; cursor: pointer; }
        .automated { box-shadow: 0 0 10px 2px #3c744c; border-color: #3c744c; cursor: not-allowed; }
        .worker { width: 25px; height: 25px; border-radius: 50%; position: absolute; top: -10px; display: none; } /* This will be hidden when the desk is automated */
        .progress-bar { width: 80%; height: 6px; background-color: #ddd; border-radius: 3px; overflow: hidden; margin-top: 5px; display: none; }
        .progress-bar-fill { height: 100%; width: 0; background-color: #33348c; transition: width linear; }

        /* Positioning each desk based on your numbered layout */
        #deskContainer1 { top: 51%; left: 42%; }
        #deskContainer2 { top: 25%; left: 42%; }
        #deskContainer3 { top: 51%; left: 78%; }
        #deskContainer4 { top: 51%; left: 10%; }
        #deskContainer5 { top: 68%; left: 58%; }
        #deskContainer6 { top: 68%; left: 25%; }
        #deskContainer7 { top: 68%; left: 79%; }
        #deskContainer8 { top: 68%; left: 5%; }
        #deskContainer9 { top: 84%; left: 60%; }
        #deskContainer10 { top: 84%; left: 30%; }

        #infoPanel { margin-top: 20px; font-weight: bold; text-align: center; }
        #notification { color: #3c744c; font-weight: bold; margin-top: 10px; min-height: 20px; transition: opacity 0.5s; opacity: 0; }
        #totalPointsDisplay { font-size: 16px; margin-bottom: 10px; font-weight: bold; color: #333; }

        /* Floating points styling */
        .floating-points {
            position: absolute;
            font-size: 12px;
            color: #33348c; /* Set the color to purple */
            transition: transform 1s ease, opacity 1s ease; /* Smooth transition */
            opacity: 1; /* Start fully visible */
        }

        /* Student image styling */
        .student-image {
            position: absolute;
            width: 25px; /* Adjust size as needed */
            height: 25px; /* Adjust size as needed */
            display: none; /* Start hidden */
            border-radius: 50%; /* Make it circular */
        }
		
			#titleScreen {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: #f4f4f4;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			z-index: 10;
		}

		#titleImage {
			max-width: 80%;
			height: auto;
			margin-bottom: 20px;
		}

		#startButton {
			padding: 10px 20px;
			font-size: 18px;
			background-color: #33348c;
			color: #fff;
			border: none;
			border-radius: 5px;
			cursor: pointer;
		}

		#startButton:hover {
			background-color: #5555aa;
		}

		#gameArea {
			display: block;
		}


		/* End Screen Styling */
		#endScreen {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.5); /* Dark overlay */
			display: flex;
			align-items: center;
			justify-content: center;
			visibility: hidden; /* Hidden by default */
			opacity: 0;
			transition: opacity 0.3s ease;
		}

		#endScreenContent {
			background: rgba(255, 255, 255, 0.9) url('RMACRAOUniversityTransition.png') center/cover no-repeat;
			padding: 20px;
			border-radius: 10px;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
			text-align: center;
		}

		#replayButton, #nextLevelButton {
			padding: 10px 20px;
			margin: 10px;
			font-size: 16px;
			background-color: #33348c;
			color: #fff;
			border: none;
			border-radius: 5px;
			cursor: pointer;
		}

		#replayButton:hover, #nextLevelButton:hover {
			background-color: #5555aa;
		}

	#specialProjectsPanel {
		position: absolute; /* Anchors the panel to a fixed position */
		top: 575px; /* Adjust to align just below the game area */
		left: 50%; /* Center horizontally */
		transform: translateX(-50%); /* Center alignment correction */
		z-index: 10; /* Ensure it stays on top */
		display: block; /* Ensure proper rendering */
	}

		.modal {
			display: none; /* Hidden by default */
			position: absolute;
			top: 40%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 500px;
			height: auto;
			background-color: white;
			z-index: 1000;
			justify-content: center;
			align-items: center;
			border-radius: 10px;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
			text-align: center;
		}


		.modal-content {
			display: flex;
			z-index: 2;
			flex-direction: row;
			align-items: center;
			justify-content: space-between;
			width: 500px;
			height: 100%;
			padding: 0;
			background-color: white;
			border-radius: 10px;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
		}
		#startGameButton:hover {
			background-color: #6B28A6;
			color: white;
		}

		.chapter-option {
			display: flex;
			flex-direction: column;
			align-items: center;
			margin-bottom: 25px; /* Adjust spacing between options */
			margin-left: -80px; /* Move closer to the character (adjust as needed) */
		}

		.chapter-preview {
			width: 155px; /* Adjust size as needed */
			height: auto;
			margin: 0 auto; /* Centers the image horizontally */			
			margin-bottom: 5px; /* Adjust spacing between image and text */
			border-radius: 5px; /* Optional: rounded corners for images */
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); /* Add shadow */
			cursor: pointer; /* Make it clickable */
			transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth hover animations */
		}

		.chapter-preview:hover {
			transform: scale(1.05); /* Slight zoom effect */
			box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3); /* Increase shadow on hover */
		}

		.chapter-option p {
			margin: 0; /* Removes extra space around the text */
			font-size: 16px; /* Adjust font size if needed */
			font-weight: bold; /* Makes the text bold */
			color: #4B0082; /* RMACRAO purple */
			text-align: center;
			margin-left: 0px; /* Moves text closer to the character */
		}


		chapterbutton {
			padding: 10px 10px;
			font-size: 16px;
			background-color: #33348c;
			color: white;
			border: none;
			border-radius: 5px;
			cursor: pointer;
		}

		chapterbutton:hover {
			background-color: #5555aa;
		}

.text-container {
    margin-left: 10px; /* Adjust to move closer to the image */
    text-align: left; /* Optional: Align text to the left */
    line-height: 1.8; /* Stretch lines (default is 1.0 or 1.2) */
    max-width: 400px; /* Limit the width for better readability */
}

.text-container p {
    margin: 10px 0; /* Add spacing between paragraphs */
}


/* Modal Container */
.endmodal {
    display: none; /* Hidden by default */
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 500px;
    height: auto;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent overlay */
}

/* Modal Content Box */
.endmodal-content {
    background-color: white;
    margin: 15% auto;
    padding: 20px;
    border-radius: 10px;
    width: 80%;
    max-width: 500px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    text-align: center;
    position: relative;
}

/* Close Button */
.endmodalclose-button {
    position: absolute;
    top: 10px;
    right: 20px;
    font-size: 1.5rem;
    cursor: pointer;
}

/* Character Image */
.endmodalcharacter-image {
    max-width: 100%;
    height: auto;
    margin-bottom: 20px;
    border-radius: 10px;
}
		
		
		
		
		
    </style>
</head>
<body>


<div id="welcomeMessage">Welcome to RMACRAO University: Registrar Level 1! This level will focus on FERPA. Click the desk to get started.</div>

<div id="totalPointsDisplay">Total CSP Earned: 0</div>

<div id="gameArea">
    <!-- Initial Desk - Add/Drop Desk -->
    <div class="desk-container" id="deskContainer1">
        <div class="desk" id="desk1" onclick="serveStudent(1)">Add/Drop</div>
        <div class="worker" id="worker1"></div>
        <div class="progress-bar" id="progressBar1"><div class="progress-bar-fill" id="progressFill1"></div></div>
    </div>
    <!-- Add the student image element -->
    <img id="studentImage" src="Student1.png" alt="Student Worker" class="student-image" />
</div>

<!-- End Screen Popup -->
<div id="endScreen">
    <div id="endScreenContent">
        <h2>Office Successfully Managed!</h2>
        <p id="finalScore"></p>
        <button id="replayButton" onclick="replayLevel()">Replay Level</button>
		<button id="nextLevelButton" onclick="loadNextLevel()">Next Level</button>
    </div>
</div>

<div id="titleScreen">
    <img src="RMACRAOUniversityTitle.png" alt="RMACRAO University: From Admissions to Graduation" id="titleImage">
    <button id="homeStartButton">Start Game</button>
</div>

<div id="infoPanel">
    <div id="notification"></div>
    <p id="pointsDisplay">Customer Service Points (CSP): 0</p>
	<p id="additionalText" style="margin-top: 10px; color: #333;">Special projects available this level: Provost Project, Strateic Initiative, and Student Success </p>
    <button id="buyDeskButton" onclick="buyNextDesk()">Degree Audit (100 CSP)</button>
    <button id="hireWorkerButton1" onclick="hireWorker(1, 30)">Hire Work-Study Student for Add/Drop Desk (30 CSP)</button>
</div>

<div id="specialProjectsPanel">
    <button id="provostProject" style="display: none;" onclick="triggerSpecialProject('provostProject')">Provost Project</button>
    <button id="strategicProject" style="display: none;" onclick="triggerSpecialProject('strategicProject')">Strategic Project</button>
    <button id="studentProject" style="display: none;" onclick="triggerSpecialProject('studentProject')">Student Project</button>
</div>

<div id="welcomeModal" class="modal">
    <div class="modal-content">
        <!-- Character Image -->
        <div class="presenter-container">
            <img id="presenterImage" src="RMACRAOUniversityPresenter1.png" alt="Presenter" style="width: 255px; height: auto;">
        </div>

        <!-- Text Content -->
        <div class="text-container" style="text-align: left; line-height: 1.8; max-width: 500px;">
            <!-- Welcome Text -->
            <p style="text-align: Center; margin-bottom: 20px;">
               <!--  <span style="font-size: 1.5em;">Welcome to </span> -->
                <span style="font-size: 1.5em;">Welcome to <strong>RMACRAO University!</strong></span>
            </p>

            <!-- "Here is how to play" Section -->
            <p style="text-align: left; margin-left: 0px; font-size: 1.2em; margin-bottom: 10px;">
                Here is how to play:
            </p>

            <!-- Instructions Section -->
            <div style="margin-left: -50px;"> <!-- Adjusted to move closer to the character -->
                <p style="margin: 5px 0;">üñ±Ô∏è <strong>Click on desks</strong> to process student requests and earn Customer Service Points (CSP).</p>
                <p style="margin: 5px 0;">üë©‚Äçüéì <strong>Hire Work-Study Students</strong> to automate desks and boost productivity.</p>
                <p style="margin: 5px 0;">‚≠ê <strong>Complete special projects</strong> to unlock exciting multipliers and bonuses!</p>
                <p style="margin: 5px 0;">‚è∞ <strong>Manage your time wisely</strong> to maximize your points and efficiency.</p>
            </div>

            <!-- Button Section -->
            <div style="margin-left: 25px; margin-top: 20px;">
                <button id="modalStartButton" style="padding: 10px 20px; font-size: 16px;">Let's Go!</button>
            </div>
        </div>
    </div>
</div>




<div id="chapterSelectionModal" class="modal">
    <div class="modal-content">
        <div class="presenter-container">
            <img src="RMACRAOUniversityPresenter2.png" alt="Presenter" style="width: 150px; height: auto; margin-left: 10;">
        </div>
        <div class="text-container">
            <p style="margin-left: -60px; text-align: left; font-size: 18px; font-weight: bold; color: #4B0082;">
                Please select a chapter to begin:
            </p>
            <div class="chapter-option">
                <a href="#" id="admissionsChapterButton" onclick="startAdmissionsChapter()" class="chapter-link">
                    <img src="RMACRAOUniversity15.png" alt="Admissions Preview" class="chapter-preview">
                </a>
                <p>Admissions Chapter</p>
            </div>

            <div class="chapter-option">
                <a href="#" id="registrarChapterButton" onclick="startRegistrarChapter()" class="chapter-link">
                    <img src="RMACRAOUniversity1.png" alt="Registrar Preview" class="chapter-preview">
                </a>
                <p>Registrar Chapter</p>
            </div>
        </div>
    </div>
</div>

<div id="endModal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeModal()">√ó</span>
        <div class="modal-body">
            <div class="modal-text">
                <h2>Congratulations!</h2>
                <p><strong id="finalScoreModal"></strong></p>
                <button onclick="replayLevel()">Replay Level</button>
                <button onclick="nextLevel()">Next Level</button>
            </div>
            <img id="characterImage" src="RMACRAOUniversityPresenter3.png" alt="Character" class="character-image">
        </div>
    </div>
</div>






















<script>

		document.addEventListener("DOMContentLoaded", () => {
			const homeStartButton = document.getElementById("homeStartButton");
			const modalStartButton = document.getElementById("modalStartButton");

			// When Start Game button is clicked
			homeStartButton.addEventListener("click", () => {
				console.log("Home Start Button clicked"); // Debugging line
				document.getElementById("titleScreen").style.display = "none"; // Hide title screen
				document.getElementById("welcomeModal").style.display = "flex"; // Show intro modal
			});

			// When Let's Go! button is clicked
			modalStartButton.addEventListener("click", () => {
				document.getElementById("welcomeModal").style.display = "none"; // Hide intro modal
				document.getElementById("chapterSelectionModal").style.display = "flex"; // Show chapter selection modal
			});
		});

		function startRegistrarChapter() {
			document.getElementById("chapterSelectionModal").style.display = "none"; // Hide the modal
			document.getElementById("gameArea").style.display = "block"; // Show game area

				// Show relevant sections
			//document.getElementById("tipsSection").style.display = "block";
			//document.getElementById("projectsSection").style.display = "block";

			// Reset game state
			csp = 0;
			totalCspEarned = 0;
			deskUnlocked = { 1: true }; // Only unlock the first desk
			hasWorker = {};
			deskInProgress = {};
			nextDeskToBuy = 2; // Reset to the first purchasable desk

			updateDisplay(); // Ensure the display is consistent with the reset state

			setupLevel1(); // Initialize Level 1 desks
			startGame();
		}


		function startAdmissionsChapter() {
			window.location.href = "RegistrarStory_Level4.html"; // Replace with the actual file name
		}



	// Move the startGame function outside of the DOMContentLoaded event
	function startGame() {
		console.log("Game started"); // Debugging line
		document.getElementById("titleScreen").style.display = "none";
		document.getElementById("welcomeModal").style.display = "none";
		document.getElementById("gameArea").style.display = "block";

		// Reset game state
		csp = 0;
		totalCspEarned = 0;
		deskUnlocked = { 1: true }; // Only unlock the first desk
		hasWorker = {}; // Clear worker assignments
		deskInProgress = {}; // Reset desks in progress
		nextDeskToBuy = 2; // Reset the next desk to buy

		setupLevel1(); // Initialize desks for Level 1
		updateDisplay(); // Update the UI to reflect the reset state
	}






    let csp = 0;
    let totalCspEarned = 0;
    let deskUnlocked = { 1: true };
    let hasWorker = {};
    let processingTimes = { 1: 500 };
    let pointsPerDesk = { 1: 2 };
    let nextDeskToBuy = 2;
    let baseDeskCost = 50;
    let baseHireCost = 30;
    let deskInProgress = {};
	let usedImages = []; // Initialize an array to keep track of used images
	let currentQuestionIndex = 0; // Declare globally at the top of your script
	let finalCspAtCompletion = 0; // Holds the total CSP when the game ends
	let gameEnded = false; // Prevents re-triggering end-game logic

    const penaltyTime = 30000; // 30 seconds penalty time

    const deskLabels = [
        "Add/Drop", 
		"Degree Audit", 
		"Transcript Request",
        "Enrollment Verification", 
		"Graduation Clearance", 
		"Academic Appeals",
        "Health and Safety", 
		"Major Changes", 
		"Registrar Reporting",
        "Course Overrides"
    ];


    // Array of student image paths
    const studentImages = [
        'Student1.png',
        'Student2.png',
        'Student3.png',
        'Student4.png',
        'Student5.png',
        'Student6.png',
        'Student7.png',
        'Student8.png',
        'Student9.png',
        'Student10.png',
    ];

	const ferpaQuestions = [
		{
			question: "Under FERPA, when can a parent request to add or drop a course on behalf of their child?",
			options: [
				"Always, as long as they are the parent.",
				"Only if the student is a dependent and the parent provides proof.",
				"Never, course changes must always be requested by the student."
			],
			answer: 1 // Correct: "Only if the student is a dependent and the parent provides proof."
		},
		{
			question: "When can a degree audit be shared with a student‚Äôs employer under FERPA regulations?",
			options: [
				"Only if the student provides explicit, written consent.",
				"Never, as degree audits are strictly internal documents.",
				"Only verbally, to maintain confidentiality of detailed records."
			],
			answer: 0 // Correct: "Only if the student provides explicit, written consent."
		},
		{
			question: "What is required to issue a student‚Äôs transcript to a third party under FERPA?",
			options: [
				"Payment of a fee by the third party.",
				"Written authorization from the student.",
				"A clear academic purpose stated by the third party."
			],
			answer: 1 // Correct: "Written authorization from the student."
		},
		{
			question: "Can a school share a student‚Äôs enrollment status with external agencies without consent?",
			options: [
				"Yes, if it is directory information as defined by the institution.",
				"No, enrollment status can never be shared externally.",
				"Yes, but only for government agency requests."
			],
			answer: 0 // Correct: "Yes, if it is directory information as defined by the institution."
		},
		{
			question: "When is it permissible to share a student‚Äôs graduation status with media outlets?",
			options: [
				"If the status is classified as directory information under FERPA.",
				"Never, media outlets cannot receive student information.",
				"Only with explicit written consent from the student."
			],
			answer: 0 // Correct: "If the status is classified as directory information under FERPA."
		},
		{
			question: "Under what circumstances can an academic appeals board access a student‚Äôs disciplinary records?",
			options: [
				"Automatically, as part of the appeals process.",
				"Only if the student provides written consent.",
				"Never, disciplinary records are strictly confidential."
			],
			answer: 1 // Correct: "Only if the student provides written consent."
		},
		{
			question: "Does FERPA allow the disclosure of student information during a health or safety emergency?",
			options: [
				"Yes, if necessary to protect the health or safety of individuals.",
				"No, FERPA prohibits disclosure even in emergencies.",
				"Yes, but only to the student‚Äôs parents."
			],
			answer: 0 // Correct: "Yes, if necessary to protect the health or safety of individuals."
		},
		{
			question: "When can a parent access information about their child‚Äôs change of major under FERPA?",
			options: [
				"Always, as parents are entitled to this information.",
				"Only if the student provides explicit consent.",
				"Never, only the student can access their academic records."
			],
			answer: 1 // Correct: "Only if the student provides explicit consent."
		},
		{
			question: "Can the registrar‚Äôs office share a student‚Äôs academic performance with their academic advisor?",
			options: [
				"Yes, if the information is relevant to the advisor's role in supporting the student.",
				"No, academic performance can only be disclosed with written consent from the student.",
				"No, FERPA prohibits this type of internal communication."
			],
			answer: 0 // Correct: "Yes, if the information is relevant to the advisor's role in supporting the student."
		},
		{
			question: "Can a professor request a course override for a student without the student‚Äôs consent?",
			options: [
				"No, overrides must involve student consent or knowledge.",
				"Yes, if the professor deems it necessary for academic progress.",
				"Yes, as long as the request aligns with institutional policy."
			],
			answer: 0 // Correct: "No, overrides must involve student consent or knowledge."
		}
	];


	const feedbackMessages = [
		{
			incorrect1: "FERPA only allows parental access if the student is a dependent for tax purposes.",
			incorrect2: "FERPA allows parental access in some cases, such as dependency."
		},
		{
			incorrect1: "FERPA requires explicit written consent for sharing educational records externally.",
			incorrect2: "FERPA mandates written consent, even for verbal disclosures."
		},
		{
			incorrect1: "FERPA requires written consent for transcripts, regardless of fees.",
			incorrect2: "FERPA does not allow transcript release without authorization."
		},
		{
			incorrect1: "FERPA allows directory information, such as enrollment status, to be shared unless the student opts out.",
			incorrect2: "FERPA permits disclosure of directory information without special restrictions."
		},
		{
			incorrect1: "FERPA considers graduation status as directory information unless the student opts out.",
			incorrect2: "Media disclosures do not require written consent for directory information."
		},
		{
			incorrect1: "FERPA requires student consent to share disciplinary records.",
			incorrect2: "Disciplinary records are protected and require authorization."
		},
		{
			incorrect1: "FERPA makes exceptions for emergencies to protect health and safety.",
			incorrect2: "FERPA allows disclosure to relevant authorities, not just parents."
		},
		{
			incorrect1: "FERPA requires explicit student consent for sharing major changes.",
			incorrect2: "Parents do not have automatic access under FERPA."
		},
		{
			incorrect1: "FERPA allows sharing with school officials if they have legitimate educational interest.",
			incorrect2: "Advisors are considered school officials under FERPA."
		},
		{
			incorrect1: "FERPA ensures students are involved in decisions affecting their records.",
			incorrect2: "Overrides require student awareness and often their consent."
		}
	];


	const provostQuiz = [
		{
			question: "The provost requests a report on how transcript request patterns can inform student retention strategies. How should you approach this request?",
			options: ["Provide the total number of transcript requests from the past semester, grouped by academic program.", "Analyze transcript request patterns alongside student demographics and reasons for requests to identify potential retention risks.", "Focus on students with high numbers of transcript requests, as they are most likely to transfer or leave the institution."],
			answer: 1 // Analyze transcript request patterns alongside student demographics and reasons for requests to identify potential retention risks.
		},
		{
			question: "The provost has requested a breakdown of transcript requests by department, sorted by volume and reason for the request. What steps should you take to create this report while ensuring FERPA compliance?",
			options: ["Aggregate and anonymize the data, ensuring no personally identifiable information is included.", "Provide raw transcript logs for analysis and include student IDs for accuracy.", "Only report on departments with a significant number of requests to save time."],
			answer: 0 // Aggregate and anonymize the data, ensuring no personally identifiable information is included.
		},
		{
			question: "The provost wants to evaluate whether the current transcript request process meets the needs of both students and external stakeholders. What should you include in your evaluation?",
			options: ["Summarize the transcript fee structure to demonstrate alignment with institutional budgeting.", "Review the number of transcripts processed over the past year to show volume trends.", "Analyze processing times, common issues reported by students, and satisfaction survey results from both students and recipients."],
			answer: 2 // Analyze processing times, common issues reported by students, and satisfaction survey results from both students and recipients.
		}
	];

	const strategicQuiz = [
		{
			question: "The academic appeals committee has noted a high number of appeals related to grade disputes in a specific department. The provost has asked you to recommend strategies for addressing this issue. What is the best course of action?",
			options: ["Collaborate with the department to review grading practices and provide training or guidelines for faculty to ensure consistency and transparency.", "Recommend that all grade disputes in the department be automatically approved to reduce the number of appeals.", "Suggest revising the appeals policy to make it harder for students to file appeals in this department."],
			answer: 0 //Collaborate with the department to review grading practices and provide training or guidelines for faculty to ensure consistency and transparency.
		},
		{
			question: "A student appeals their dismissal after failing three required courses, citing extenuating circumstances, including medical issues. They provide some documentation but omit critical details. What is your next step?",
			options: ["Approve the appeal to avoid complications and ensure the student remains enrolled.", "Deny the appeal, as failing three courses indicates poor academic performance regardless of extenuating circumstances.", "Request additional documentation to clarify their medical circumstances and ensure the committee has all relevant information before making a decision."],
			answer: 2 //Request additional documentation to clarify their medical circumstances and ensure the committee has all relevant information before making a decision.
		},
		{
			question: "The strategic initiative aims to reduce repeat appeals by identifying patterns and improving policies. How should you approach this task?",
			options: ["Implement stricter criteria for accepting appeals to reduce the volume of submissions.", "Analyze appeal data to identify common reasons for appeals, work with departments to address recurring issues, and recommend policy adjustments.", "Recommend a centralized appeals process where all decisions are final and not subject to review."],
			answer: 1 //Analyze appeal data to identify common reasons for appeals, work with departments to address recurring issues, and recommend policy adjustments.
		}
	];

	const studentQuiz = [
		{
			question: "The director of student success has requested a report identifying trends among students who withdraw from multiple courses each semester. How should you approach creating this report?",
			options: ["Focus on students in specific programs with high withdrawal rates and suggest they receive academic warnings.", "Provide a list of students who have withdrawn from three or more courses, grouped by their GPA and major.", "Analyze withdrawal data to identify patterns by demographics, course type, and timing, and include insights into potential underlying issues like scheduling conflicts or academic challenges."],
			answer: 2 //Analyze withdrawal data to identify patterns by demographics, course type, and timing, and include insights into potential underlying issues like scheduling conflicts or academic challenges.
		},
		{
			question: "The Student Success Drive requires outreach to students flagged as at risk due to low GPA. What is the best approach for using registrar data to inform this outreach?",
			options: ["Use historical GPA trends, credit completion rates, and enrollment patterns to identify at-risk students and share the data with advisors for targeted intervention. ", "Compile a list of all students with GPAs below 2.0 and send them a mass email with general support resources.", "Provide advisors with demographic data and let them decide how to approach at-risk students individually."],
			answer: 0 //Use historical GPA trends, credit completion rates, and enrollment patterns to identify at-risk students and share the data with advisors for targeted intervention. 
		},
		{
			question: "The provost has asked you to evaluate the success of the Student Success Drive by assessing its impact on retention rates. How should you structure your evaluation?",
			options: ["Report on the number of emails sent and meetings held with at-risk students to show outreach volume.", "Compare retention rates before and after the initiative, and include student feedback on the effectiveness of the interventions provided.", "Focus on analyzing the GPAs of students who participated in the initiative to assess their academic improvement."],
			answer: 1 //Compare retention rates before and after the initiative, and include student feedback on the effectiveness of the interventions provided.
		}
	];

	function setupLevel1() {
		const gameArea = document.getElementById("gameArea");
		gameArea.innerHTML = ""; // Clear existing desks

		deskLabels.forEach((label, index) => {
			const deskNumber = index + 1;

			// Only add desks that are unlocked
			if (deskUnlocked[deskNumber]) {
				const deskContainer = document.createElement("div");
				deskContainer.className = "desk-container";
				deskContainer.id = `deskContainer${deskNumber}`;

				const desk = document.createElement("div");
				desk.className = "desk";
				desk.id = `desk${deskNumber}`;
				desk.innerText = label;
				desk.onclick = () => serveStudent(deskNumber);

				const worker = document.createElement("div");
				worker.className = "worker";
				worker.id = `worker${deskNumber}`;

				const progressBar = document.createElement("div");
				progressBar.className = "progress-bar";
				progressBar.id = `progressBar${deskNumber}`;

				const progressFill = document.createElement("div");
				progressFill.className = "progress-bar-fill";
				progressFill.id = `progressFill${deskNumber}`;

				progressBar.appendChild(progressFill);
				deskContainer.appendChild(desk);
				deskContainer.appendChild(worker);
				deskContainer.appendChild(progressBar);
				gameArea.appendChild(deskContainer);
			}
		});
	}



    function showNotification(message) {
        const notification = document.getElementById("notification");
        notification.innerText = message;
        notification.style.opacity = 1;
        setTimeout(() => { notification.style.opacity = 0; }, 3000);
    }

    function updateDisplay() {
        document.getElementById("pointsDisplay").innerText = `Customer Service Points (CSP): ${csp}`;
        document.getElementById("totalPointsDisplay").innerText = `Total CSP Earned: ${totalCspEarned}`;
    }

	function createFloatingPoints(points, deskNumber) {
		const pointElement = document.createElement("div");
		pointElement.className = "floating-points";
		pointElement.innerText = `+${points} CSP`; // Removed the dollar sign and added "CSP" label

		pointElement.style.color = '#33348c'; // Set the color to purple

		// Position the element at the desk's location
		const desk = document.getElementById(`deskContainer${deskNumber}`);
		const deskRect = desk.getBoundingClientRect();
		pointElement.style.left = `${deskRect.left + deskRect.width / 2}px`;
		pointElement.style.top = `${deskRect.top + deskRect.height / 2}px`;

		document.body.appendChild(pointElement);

		// Animate the points floating away from the desk
		setTimeout(() => {
			pointElement.style.transform = 'translateY(-50px)'; // Adjust the value to change how far it floats
			pointElement.style.opacity = 0; // Fade out effect
		}, 0);

		// Remove the element after the animation is complete
		setTimeout(() => {
			pointElement.remove();
		}, 1050); // Adjust timing to match the animation duration
	}

    function buyNextDesk() {
        const deskNumber = nextDeskToBuy;
        const deskCost = baseDeskCost * deskNumber;
        if (csp >= deskCost && !deskUnlocked[deskNumber]) {
            csp -= deskCost;
            deskUnlocked[deskNumber] = true;

            // Show FERPA question before unlocking the desk
            showFERPAPopup(deskNumber);
        } else {
            showNotification("Not enough CSP!");
        }
    }

	function showFERPAPopup(deskNumber) {
		const popup = document.createElement("div");
		const question = ferpaQuestions[deskNumber - 1].question;
		const options = ferpaQuestions[deskNumber - 1].options;
		const correctAnswer = ferpaQuestions[deskNumber - 1].answer;


		popup.id = "ferpaQuestionPopup";
		popup.innerHTML = `
			<div style="background-color: white; padding: 20px; border: 1px solid #ccc;">
				<h3>Customer Service Question</h3>
				<p>${ferpaQuestions[deskNumber - 1].question}</p>
				${ferpaQuestions[deskNumber - 1].options.map((option, index) => `
					<label>
						<input type="radio" name="ferpaOption" value="${index}"> ${option}
					</label><br>
				`).join('')}
				<button onclick="checkFERPAAnswer(${deskNumber})">Submit</button>
				<button onclick="closeFERPAPopup()">Cancel</button>
			</div>
		`;
		document.body.appendChild(popup);
	}

    function closeFERPAPopup() {
        const popup = document.getElementById("ferpaQuestionPopup");
        if (popup) {
            document.body.removeChild(popup);
        }
    }

	function checkFERPAAnswer(deskNumber) {
		const selectedOption = document.querySelector('input[name="ferpaOption"]:checked');
		if (selectedOption) {
			const selectedIndex = parseInt(selectedOption.value);
			const correctAnswer = ferpaQuestions[deskNumber - 1].answer;
			const feedback = feedbackMessages[deskNumber - 1];

			if (selectedIndex === correctAnswer) {
				closeFERPAPopup();
				unlockDesk(deskNumber); // Unlock the desk if the answer is correct
			} else {
				const feedbackMessage =
					selectedIndex === 1 ? feedback.incorrect1 :
					selectedIndex === 2 ? feedback.incorrect2 :
					"Incorrect answer. Please try again.";
				showNotification(`${feedbackMessage} You have a 30-second penalty before trying again.`);
				closeFERPAPopup();
				setTimeout(() => showFERPAPopup(deskNumber), penaltyTime);
			}
		} else {
			showNotification("Please select an answer.");
		}
	}


	function unlockDesk(deskNumber) {
		const newDeskContainer = document.createElement("div");
		newDeskContainer.className = "desk-container";
		newDeskContainer.id = `deskContainer${deskNumber}`;

		const newDesk = document.createElement("div");
		newDesk.className = "desk";
		newDesk.id = `desk${deskNumber}`;
		newDesk.innerText = deskLabels[deskNumber - 1];
		newDesk.onclick = () => serveStudent(deskNumber);

		const worker = document.createElement("div");
		worker.className = "worker";
		worker.id = `worker${deskNumber}`;

		// Ensure progress bar and progress fill are created for every desk
		const progressBar = document.createElement("div");
		progressBar.className = "progress-bar";
		progressBar.id = `progressBar${deskNumber}`;
		progressBar.style.display = "block";

		const progressFill = document.createElement("div");
		progressFill.className = "progress-bar-fill";
		progressFill.id = `progressFill${deskNumber}`;

		progressBar.appendChild(progressFill);
		newDeskContainer.appendChild(newDesk);
		newDeskContainer.appendChild(worker);
		newDeskContainer.appendChild(progressBar);
		document.getElementById("gameArea").appendChild(newDeskContainer);

		processingTimes[deskNumber] = processingTimes[deskNumber - 1] + 2000;
		pointsPerDesk[deskNumber] = pointsPerDesk[deskNumber - 1] + 3;

		const hireCost = baseHireCost * deskNumber;
		const hireWorkerButton = document.createElement("button");
		hireWorkerButton.id = `hireWorkerButton${deskNumber}`;
		hireWorkerButton.innerText = `Hire Work-Study Student for ${deskLabels[deskNumber - 1]} (${hireCost} CSP)`;
		hireWorkerButton.onclick = () => hireWorker(deskNumber, hireCost);
		document.getElementById("infoPanel").appendChild(hireWorkerButton);

		nextDeskToBuy += 1;
		if (nextDeskToBuy <= deskLabels.length) {
			document.getElementById("buyDeskButton").innerText = `Buy ${deskLabels[nextDeskToBuy - 1]} (${baseDeskCost * nextDeskToBuy} CSP)`;
		} else {
			document.getElementById("buyDeskButton").style.display = "none";
		}

		updateDisplay();
		showNotification(`${deskLabels[deskNumber - 1]} unlocked!`);
		
		// Unlock special projects when specific desks are purchased in Level
		if (deskNumber === 3) unlockSpecialProject('provostProject'); // Provost Project should unlock first
		if (deskNumber === 6) unlockSpecialProject('strategicProject');
		if (deskNumber === 9) unlockSpecialProject('studentProject');
	}


	function serveStudent(deskNumber) {
		// When the desk is not automated
		if (deskUnlocked[deskNumber] && !hasWorker[deskNumber]) {
			if (!deskInProgress[deskNumber]) {
				deskInProgress[deskNumber] = true;

				// Get the progress bar and progress fill elements
				const progressBar = document.getElementById(`progressBar${deskNumber}`);
				const progressFill = document.getElementById(`progressFill${deskNumber}`);
				
				// Show the progress bar and reset it
				progressBar.style.display = "block";
				progressFill.style.transition = 'none';
				progressFill.style.width = '0%';

				// Start the smooth filling of the progress bar
				setTimeout(() => {
					progressFill.style.transition = `width ${processingTimes[deskNumber]}ms linear`;
					progressFill.style.width = '100%';
				}, 50); // Small delay to ensure transition effect

				// Complete the task after the specified time
				setTimeout(() => {
					csp += pointsPerDesk[deskNumber];
					totalCspEarned += pointsPerDesk[deskNumber];
					updateDisplay();
					createFloatingPoints(pointsPerDesk[deskNumber], deskNumber);
					showNotification(`Served a student at ${deskLabels[deskNumber - 1]}`);

					// Reset and hide the progress bar after filling
					progressFill.style.transition = 'none';
					progressFill.style.width = '0%';
					deskInProgress[deskNumber] = false;
					progressBar.style.display = "none";
				}, processingTimes[deskNumber]);
			}
		} 
		// When the desk is automated
		else if (deskUnlocked[deskNumber] && hasWorker[deskNumber]) {
			showNotification(`This desk is automated. Please wait for processing.`);
			return;
		}
	}




	 function hireWorker(deskNumber, hireCost) {
		if (csp >= hireCost && !hasWorker[deskNumber]) {
			csp -= hireCost;
			hasWorker[deskNumber] = true;
			document.getElementById(`worker${deskNumber}`).style.display = "none"; // Hide the worker
			document.getElementById(`desk${deskNumber}`).classList.add("automated");
			document.getElementById(`progressBar${deskNumber}`).style.display = "block";
			document.getElementById(`hireWorkerButton${deskNumber}`).style.display = "none";
			startAutoProcessing(deskNumber);
			updateDisplay();

			// Select a unique, unused image
			let randomIndex;
			do {
				randomIndex = Math.floor(Math.random() * studentImages.length);
			} while (usedImages.includes(randomIndex) && usedImages.length < studentImages.length);

			// Add the selected image index to the used list
			if (!usedImages.includes(randomIndex)) {
				usedImages.push(randomIndex);
			}


			// Show the student image for the desk
			const studentImage = document.createElement("img");
			studentImage.className = "student-image";
			studentImage.src = studentImages[randomIndex];
			studentImage.style.display = "block";
			studentImage.style.top = `${document.getElementById(`deskContainer${deskNumber}`).offsetTop - 15}px`;
			studentImage.style.left = `${document.getElementById(`deskContainer${deskNumber}`).offsetLeft + 30}px`;
			document.getElementById("gameArea").appendChild(studentImage);
		} else {
			showNotification("Not enough CSP!");
		}
	}


	function startAutoProcessing(deskNumber) {
		function processTask() {
			if (!deskInProgress[deskNumber]) {
				deskInProgress[deskNumber] = true;

				const progressFill = document.getElementById(`progressFill${deskNumber}`);

				// Reset progress bar
				progressFill.style.transition = 'none'; // Disable animation for reset
				progressFill.style.width = '0%'; // Reset width to 0%

				// Start filling progress bar
				setTimeout(() => {
					progressFill.style.transition = `width ${processingTimes[deskNumber]}ms linear`; // Smooth transition
					progressFill.style.width = '100%'; // Fill the bar
				}, 50); // Slight delay to visually reset the bar

				// Complete the task after the bar fills
				setTimeout(() => {
					// Update CSP and total points
					csp += pointsPerDesk[deskNumber];
					totalCspEarned += pointsPerDesk[deskNumber];
					updateDisplay();

					// Create floating points effect
					createFloatingPoints(pointsPerDesk[deskNumber], deskNumber);

					// Mark desk as ready for the next cycle
					deskInProgress[deskNumber] = false;

					// Immediately start the next task
					processTask();
				}, processingTimes[deskNumber]); // Matches the fill duration
			}
		}

		// Start the first task
		processTask();
	}
	



    function showStudentImage(deskNumber) {
        const studentImage = document.createElement("img");
        studentImage.className = "student-image"; // Add class for styling
        const randomIndex = Math.floor(Math.random() * studentImages.length);
        studentImage.src = studentImages[randomIndex]; // Use random image
        studentImage.style.display = "block"; // Show the student image
        // Position it at the desk
        studentImage.style.top = `${document.getElementById(`deskContainer${deskNumber}`).offsetTop - 1000}px`; // Adjust positioning
        studentImage.style.left = `${document.getElementById(`deskContainer${deskNumber}`).offsetLeft + 30}px`; // Adjust positioning
        document.getElementById("gameArea").appendChild(studentImage); // Append new image to the game area
    }

    updateDisplay();
	
	function unlockSpecialProject(projectId) {
		const projectButton = document.getElementById(projectId);
		if (projectButton) {
			projectButton.style.display = 'block'; // Show the button
			projectButton.onclick = () => triggerSpecialProject(projectId); // Bind the handler
			showNotification(`Special Project Unlocked: ${projectButton.innerText}`);
		} else {
			console.error(`Special project button with ID "${projectId}" not found.`);
		}
	}

		
	function triggerSpecialProject(projectId) {
		let quiz;
		currentQuestionIndex = 0;
		switch (projectId) {
			case 'provostProject': // Provost Project logic
				quiz = provostQuiz;
				break;
			case 'strategicProject': // Strategic Project logic
				quiz = strategicQuiz;
				break;
			case 'studentProject': // Student Success logic
				quiz = studentQuiz;
				break;
			default:
				console.error(`Unknown project ID: ${projectId}`);
				return;
		}

		// Show the quiz popup
		currentQuestionIndex = 0; // Reset the index before starting
		showQuizPopup(quiz, projectId);
	}
		
	function showQuizPopup(quiz, projectId) {
		let quizPopup = document.getElementById('quizPopup');
		if (!quizPopup) {
			quizPopup = document.createElement('div');
			quizPopup.id = 'quizPopup';
			quizPopup.style = `
				position: fixed;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background: white;
				padding: 20px;
				border: 2px solid #ccc;
				z-index: 100;
				max-width: 80%;
			`;
			document.body.appendChild(quizPopup); // Add to DOM
		}
		renderQuestion(projectId, quiz); // Pass quiz to renderQuestion
	}


		function renderQuestion(projectId, quiz) {
			const quizPopup = document.getElementById('quizPopup');
			const question = quiz[currentQuestionIndex];

			quizPopup.innerHTML = `
				<h3>Special Project Quiz</h3>
				<p>${question.question}</p>
				${question.options.map((option, index) => `
					<label>
						<input type="radio" name="quizOption" value="${index}"> ${option}
					</label><br>
				`).join('')}
				<button id="submitAnswerButton">Submit</button>
			`;

			document.getElementById('submitAnswerButton').addEventListener('click', () => checkAnswer(projectId, quiz));
		}




	function checkAnswer(projectId, quiz) {
		const selectedOption = document.querySelector('input[name="quizOption"]:checked');
		if (!selectedOption) {
			alert('Please select an answer.');
			return;
		}

		const isCorrect = parseInt(selectedOption.value) === quiz[currentQuestionIndex].answer;
		if (isCorrect) {
			currentQuestionIndex++;
			if (currentQuestionIndex < quiz.length) {
				renderQuestion(projectId, quiz); // Move to the next question
			} else {
				closeQuizPopup(projectId); // Close the quiz popup and hide the button
				handleSpecialProjectRewards(true); // Reward for completion
			}
		} else {
			handleSpecialProjectRewards(false); // Penalize for incorrect answers
		}
	}




	function closeQuizPopup(projectId) {
		const quizPopup = document.getElementById('quizPopup');
		if (quizPopup) {
			document.body.removeChild(quizPopup); // Remove the quiz popup
		}

		const projectButton = document.getElementById(projectId);
		if (projectButton) {
			projectButton.style.display = 'none'; // Hide the button
		} else {
			console.error(`Special project button with ID "${projectId}" not found.`);
		}
	}


	function handleSpecialProjectRewards(isCorrect) {
		if (isCorrect) {
			csp += 50; // Reward for completing all questions correctly
			showNotification("Congratulations! You earned 50 CSP for successfully completing the special project.");
		} else {
			csp -= 20; // Penalty for incorrect answer
			showNotification("Incorrect answer. You lost 20 CSP.");
		}
		updateDisplay();
	}
	
	
		// Function to check if the end conditions are met
	function checkEndGame() {
		// Check if all desks are automated and CSP is 2,000 or more
		const allDesksAutomated = Object.keys(hasWorker).length === 10;
		if (allDesksAutomated && csp >= 1000) {
		        gameEnded = true; // Lock further updates
			        console.log("Final CSP at completion:", finalCspAtCompletion); // Debugging log
			showEndModal();
		}
	}

	function loadNextLevel() {
		window.location.href = "RegistrarStory_Level2.html"; // Update with the correct file path
	}


	// Function to show the ending modal
	function showEndModal() {
		const endModal = document.getElementById("endModal");
		const finalScoreModal = document.getElementById("finalScoreModal");

		// Update the final score dynamically
		finalScoreModal.innerText = `Hey, congrats! You managed to get all of your stations automated and working at maximum efficiency! Level 2 will focus on customer service. Let‚Äôs see if you can keep this going.`;

		// Display the modal
		endModal.style.display = "block";
	}

	// Function to close the modal
	function closeModal() {
		const endModal = document.getElementById("endModal");
		endModal.style.display = "none";
	}

	// Function for Replay Level button
	function replayLevel() {
		// Reset game variables and reload the page to restart the level
		location.reload();
	}

	// Function for Next Level button
	function nextLevel() {
		alert("Transitioning to Level 2...");
		location.href = "RegistrarStory_Level2.html"; // Link to a separate file or setup
	}


	// Call checkEndGame() after every CSP update
	function updateDisplay() {
		document.getElementById("pointsDisplay").innerText = `Customer Service Points (CSP): ${csp}`;
		document.getElementById("totalPointsDisplay").innerText = `Total CSP Earned: ${totalCspEarned}`;
		checkEndGame();
	}

		
	
	
	
</script>

</body>
</html>
